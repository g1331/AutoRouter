# Code-Argus: AI-Powered Code Review

Code-Argus æ˜¯ä¸€ä¸ªåŸºäº AI çš„ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨å‘ç°ä»£ç é—®é¢˜å¹¶æä¾›ä¿®å¤å»ºè®®ã€‚ä¸ `@autorouter-bot` é…åˆä½¿ç”¨å¯å®ç°é—®é¢˜çš„è‡ªåŠ¨ä¿®å¤ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **æ™ºèƒ½ä»£ç å®¡æŸ¥**: ä½¿ç”¨ AI æ¨¡å‹åˆ†æ PR å˜æ›´ï¼Œè¯†åˆ«æ½œåœ¨é—®é¢˜
- **å¤šè¯­è¨€æ”¯æŒ**: è‡ªåŠ¨é€‚é… PR æè¿°çš„è¯­è¨€ï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰
- **è¡Œå†…å»ºè®®**: æä¾› GitHub åŸç”Ÿçš„ suggestion æ ¼å¼ï¼Œä¸€é”®åº”ç”¨ä¿®å¤
- **Bot é›†æˆ**: å®¡æŸ¥å‘ç°é—®é¢˜æ—¶æä¾› `@autorouter-bot` è§¦å‘æç¤º

## è§¦å‘æ–¹å¼

### 1. è‡ªåŠ¨è§¦å‘

- PR åˆ›å»ºæ—¶è‡ªåŠ¨è§¦å‘å®¡æŸ¥
- PR é‡æ–°æ‰“å¼€æ—¶è‡ªåŠ¨è§¦å‘å®¡æŸ¥

### 2. æ‰‹åŠ¨è§¦å‘ï¼ˆè¯„è®ºå‘½ä»¤ï¼‰

åœ¨ PR è¯„è®ºä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

| å‘½ä»¤ | åŠŸèƒ½ |
|------|------|
| `code-argus review` | è§¦å‘ä»£ç å®¡æŸ¥ |
| `argus review` | åŒä¸Šï¼ˆç®€å†™ï¼‰ |
| `code-argus å®¡æŸ¥` | åŒä¸Šï¼ˆä¸­æ–‡ï¼‰ |

### 3. è‡ªåŠ¨ä¿®å¤

| å‘½ä»¤ | åŠŸèƒ½ |
|------|------|
| `code-argus fix` | å®¡æŸ¥ + è‡ªåŠ¨ä¿®å¤å¾ªç¯ |
| `code-argus fix-now` | è·³è¿‡å®¡æŸ¥ï¼Œç›´æ¥è§¦å‘ä¿®å¤ |
| `argus fix` / `argus fix-now` | åŒä¸Šï¼ˆç®€å†™ï¼‰ |
| `code-argus ä¿®å¤` / `code-argus ç«‹å³ä¿®å¤` | åŒä¸Šï¼ˆä¸­æ–‡ï¼‰ |

**æµç¨‹è¯´æ˜**ï¼š

- **fix**: å…ˆå®¡æŸ¥ï¼Œå‘ç°é—®é¢˜åé€šè¿‡ `repository_dispatch` è§¦å‘ `claude-codex-agent` ä¿®å¤ï¼Œå¾ªç¯ç›´åˆ°æ— é—®é¢˜æˆ–è¾¾åˆ°æœ€å¤§è½®æ¬¡
- **fix-now**: è·³è¿‡å®¡æŸ¥ï¼Œç›´æ¥è§¦å‘ä¿®å¤ï¼ˆagent ä¼šè‡ªå·±è¯»å– PR reviews æ¥äº†è§£éœ€è¦ä¿®å¤ä»€ä¹ˆï¼‰

**æ‰‹åŠ¨æ¨¡å¼**ï¼šä½¿ç”¨ `code-argus review` ä»…å®¡æŸ¥ä¸è‡ªåŠ¨ä¿®å¤ï¼Œå®¡æŸ¥ç»“æœä¼šæä¾›æ‰‹åŠ¨è§¦å‘æç¤ºã€‚

## é…ç½®

### ç¯å¢ƒå˜é‡

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­é…ç½®ï¼š

**Secretsï¼ˆå¿…éœ€ï¼‰**:
- `CODEX_API_KEY`: OpenAI/Codex API å¯†é’¥
- `CODEX_BASE_URL`: API åŸºç¡€ URLï¼ˆæ ¼å¼: `https://xxx.com/v1`ï¼‰

**Variablesï¼ˆå¯é€‰ï¼‰**:
- `CODEX_MODEL`: å®¡æŸ¥ä½¿ç”¨çš„æ¨¡å‹ï¼ˆé»˜è®¤: `gpt-5.2`ï¼‰
- `MAX_FIX_ROUNDS`: æœ€å¤§è‡ªåŠ¨ä¿®å¤è½®æ¬¡ï¼ˆé»˜è®¤: `3`ï¼‰

### ä»“åº“é…ç½®æ–‡ä»¶

åˆ›å»º `.github/reviewbot.yaml` è‡ªå®šä¹‰å®¡æŸ¥è¡Œä¸ºï¼š

```yaml
# æœ€å¤§è¯„è®ºæ•°é‡
max_comments: 10

# æœ€ä½ä¸¥é‡çº§åˆ« (low, medium, high)
min_severity: low

# è¾“å‡ºè¯­è¨€ (auto, en, zh)
language: auto
```

## å·¥ä½œæµç¨‹

### Review æ¨¡å¼ (`code-argus review`)

```
è§¦å‘: PR åˆ›å»º/é‡å¼€ æˆ– è¯„è®º "code-argus review"
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Code-Argus å®¡æŸ¥                                             â”‚
â”‚  - Checkout PR ä»£ç                                           â”‚
â”‚  - Codex åˆ†æ diff                                           â”‚
â”‚  - å‘å¸ƒè¡Œå†…è¯„è®º                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    å‘ç°é—®é¢˜æ—¶æä¾›æ‰‹åŠ¨è§¦å‘æç¤º
                    ğŸ’¡ Tip: @autorouter-bot ...
```

### Fix æ¨¡å¼ (`code-argus fix`)

```
è§¦å‘: è¯„è®º "code-argus fix"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªåŠ¨è¿­ä»£å¾ªç¯ (æœ€å¤š MAX_FIX_ROUNDS è½®)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Code-Argus   â”‚â”€â”€â”€â”€â–¶â”‚ å‘ç°é—®é¢˜ â†’ repository_dispatch   â”‚  â”‚
â”‚  â”‚ å®¡æŸ¥ (Codex) â”‚     â”‚ event: 'code-argus-fix'          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â–²                             â”‚                      â”‚
â”‚         â”‚                             â–¼                      â”‚
â”‚         â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚         â”‚             â”‚ claude-codex-agent (argus-fix)   â”‚  â”‚
â”‚         â”‚             â”‚ å®Œæ•´ MCP: auggie, context7, etc. â”‚  â”‚
â”‚         â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                             â”‚                      â”‚
â”‚         â”‚                             â–¼                      â”‚
â”‚         â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ è¯„è®º "code-argus fix"             â”‚  â”‚
â”‚                       â”‚ è§¦å‘ä¸‹ä¸€è½®å®¡æŸ¥                     â”‚  â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              æ— é—®é¢˜ æˆ– è¾¾åˆ°æœ€å¤§è½®æ¬¡ â†’ ç»“æŸ
```

## å®¡æŸ¥é‡ç‚¹

Code-Argus ä¸“æ³¨äºé«˜å½±å“åŠ›çš„é—®é¢˜ï¼š

**ä¼šå®¡æŸ¥çš„å†…å®¹**:
- **æ­£ç¡®æ€§**: é€»è¾‘é”™è¯¯ã€è¾¹ç•Œæƒ…å†µã€ç©ºå€¼å¤„ç†ã€ç«æ€æ¡ä»¶
- **å®‰å…¨æ€§**: XSSã€æ³¨å…¥ã€è®¤è¯ç»•è¿‡ã€æ•æ„Ÿæ•°æ®æš´éœ²
- **æ¶æ„**: ç ´åæ€§å˜æ›´ã€API å…¼å®¹æ€§ã€è·¨ç³»ç»Ÿå½±å“
- **æµ‹è¯•**: å…³é”®è·¯å¾„ç¼ºå°‘æµ‹è¯•ã€è¦†ç›–ç‡ä¸è¶³

**ä¸ä¼šå®¡æŸ¥çš„å†…å®¹**:
- ä»£ç é£æ ¼ã€æ ¼å¼ã€å‘½åè§„èŒƒ
- ä¸å½±å“åŠŸèƒ½çš„å°ä¼˜åŒ–
- ä¸ªäººåå¥½æˆ–"é”¦ä¸Šæ·»èŠ±"çš„å»ºè®®

## ä¸¥é‡çº§åˆ«

| çº§åˆ« | æ ‡è¯† | è¯´æ˜ |
|------|------|------|
| High | ğŸ”´ | å¿…é¡»ä¿®å¤ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡é—®é¢˜ |
| Medium | ğŸŸ¡ | å»ºè®®ä¿®å¤ï¼Œå­˜åœ¨æ½œåœ¨é£é™© |
| Low | ğŸŸ¢ | å¯é€‰ä¿®å¤ï¼Œæ”¹è¿›å»ºè®® |

## ç¤ºä¾‹

### Review æ¨¡å¼è¾“å‡º

```
## Code-Argus Review

Review completed. **3** issue(s) found.

| Severity | Count |
|----------|-------|
| ğŸ”´ High | 1 |
| ğŸŸ¡ Medium | 2 |

**Focus areas**: security, correctness

---
ğŸ’¡ **Tip**: Comment the following to trigger auto-fix:
@autorouter-bot è¯·æ ¹æ®ä¸Šæ–¹ Code-Argus review åé¦ˆä¿®å¤ä»£ç é—®é¢˜

---
Comment `code-argus review` to re-trigger review | `code-argus fix` for auto-fix loop
```

### Fix æ¨¡å¼è¾“å‡ºï¼ˆè‡ªåŠ¨è¿­ä»£ï¼‰

```
## Code-Argus Review (Round 1/3)

Review completed. **2** issue(s) found.

| Severity | Count |
|----------|-------|
| ğŸ”´ High | 1 |
| ğŸŸ¡ Medium | 1 |

ğŸ”§ **Auto-fix mode**: Triggering @autorouter-bot to fix issues...

---
Comment `code-argus review` to re-trigger review | `code-argus fix` for auto-fix loop
```

éšå Code-Argus é€šè¿‡ `repository_dispatch` è§¦å‘ `claude-codex-agent`ï¼Œå¹¶å‘é€é€šçŸ¥è¯„è®ºï¼š

```
ğŸ”§ **Code-Argus Auto-Fix** (Round 1/3)

æ­£åœ¨è§¦å‘è‡ªåŠ¨ä¿®å¤...

æŸ¥çœ‹ [Actions](https://github.com/.../actions) è·Ÿè¸ªè¿›åº¦ã€‚
```

### å®¡æŸ¥é€šè¿‡

```
## Code-Argus Review (Round 2/3)

âœ… Review completed. **No significant issues found.**

The changes look good from a correctness, security, and architecture perspective.

---
Comment `code-argus review` to re-trigger review | `code-argus fix` for auto-fix loop
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **"Review failed"**
   - æ£€æŸ¥ `CODEX_API_KEY` å’Œ `CODEX_BASE_URL` æ˜¯å¦æ­£ç¡®é…ç½®
   - æŸ¥çœ‹ workflow æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

2. **"No output received"**
   - API è°ƒç”¨å¯èƒ½è¶…æ—¶ï¼Œå°è¯•é‡æ–°è§¦å‘
   - æ£€æŸ¥ API é…é¢æ˜¯å¦å……è¶³

3. **æƒé™è¢«æ‹’ç»**
   - ä»…ä»“åº“ collaboratorsï¼ˆwrite æƒé™ä»¥ä¸Šï¼‰å¯è§¦å‘å®¡æŸ¥
   - æ£€æŸ¥è§¦å‘ç”¨æˆ·çš„æƒé™çº§åˆ«

4. **è‡ªåŠ¨ä¿®å¤æœªç”Ÿæ•ˆ**
   - æ£€æŸ¥ `claude-codex-agent` workflow çš„ `argus-fix` job æ˜¯å¦è¢«è§¦å‘
   - æŸ¥çœ‹ Actions é¡µé¢ç¡®è®¤ `repository_dispatch` äº‹ä»¶æ˜¯å¦æˆåŠŸå‘é€
   - ç¡®è®¤ä»“åº“æœ‰ `repository_dispatch` çš„è§¦å‘æƒé™

## ç›¸å…³æ–‡ä»¶

- Code-Argus Workflow: `.github/workflows/code-argus.yml`
- Auto-Fix Agent: `.github/workflows/claude-codex-agent.yml`
- å®¡æŸ¥é…ç½®: `.github/reviewbot.yaml`ï¼ˆå¯é€‰ï¼‰
