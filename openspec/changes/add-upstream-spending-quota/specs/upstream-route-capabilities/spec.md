## MODIFIED Requirements

### Requirement: 上游支持多能力配置

系统 SHALL 允许单个上游配置多个能力类型，并将该配置作为路径路由候选过滤的依据。路由选择流程中，在能力过滤和断路器过滤之后，SHALL 额外执行消费限额过滤，将已超额的上游从候选集中排除。

#### Scenario: 创建上游时配置多个能力

- **WHEN** 管理员创建上游并提交多个能力类型
- **THEN** 系统持久化完整能力集合并在后续选路中生效

#### Scenario: 更新上游能力集合

- **WHEN** 管理员在编辑上游时新增或移除能力类型
- **THEN** 系统更新存储并立即用于后续路由决策

#### Scenario: 路由选择中超额上游被排除

- **WHEN** 请求进入上游选择流程，某个能力匹配的候选上游已超过消费限额
- **THEN** 该上游在当前请求的选择中被排除，请求静默路由到其他可用上游
